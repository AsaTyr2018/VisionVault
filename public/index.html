<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VisionVault - Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <nav class="navbar navbar-dark bg-dark border-bottom border-primary px-3">
    <a class="navbar-brand logo-gradient" href="index.html">VisionVault</a>
    <div class="ms-auto d-flex gap-2">
      <a href="gallery.html" class="btn btn-secondary">Gallery</a>
      <a href="tags.html" class="btn btn-secondary">Tag Cloud</a>
      <a href="upload.html" class="btn btn-secondary">Upload</a>
      <button id="themeToggle" type="button" class="btn btn-outline-teal" title="Toggle theme">â˜€</button>
    </div>
  </nav>
  <main class="container py-5">
    <h1 class="mb-4">Dashboard</h1>
    <div id="stats" class="row g-4">
      <div class="col-md-4">
        <div class="card text-center bg-dark">
          <div class="card-body">
            <h2 id="statImages" class="card-title display-5">0</h2>
            <p class="card-text">Images</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card text-center bg-dark">
          <div class="card-body">
            <h2 id="statTags" class="card-title display-5">0</h2>
            <p class="card-text">Unique Tags</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card text-center bg-dark">
          <div class="card-body">
            <h2 id="statModels" class="card-title display-5">0</h2>
            <p class="card-text">Models Used</p>
          </div>
        </div>
      </div>
    </div>
    <h2 class="mt-5">Top Tags</h2>
    <ul id="topTags" class="list-inline mt-3"></ul>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const themeToggle = document.getElementById('themeToggle');
    function applyTheme(theme) {
      if (theme === 'light') {
        document.body.classList.add('light-theme');
        themeToggle.textContent = 'ðŸŒ™';
      } else {
        document.body.classList.remove('light-theme');
        themeToggle.textContent = 'â˜€';
      }
      localStorage.setItem('vv-theme', theme);
    }
    themeToggle.addEventListener('click', () => {
      const current = document.body.classList.contains('light-theme') ? 'light' : 'dark';
      applyTheme(current === 'light' ? 'dark' : 'light');
    });
    applyTheme(localStorage.getItem('vv-theme') || 'dark');

    fetch('/api/stats').then(r => r.json()).then(data => {
      document.getElementById('statImages').textContent = data.images;
      document.getElementById('statTags').textContent = data.tags;
      document.getElementById('statModels').textContent = data.models;
      const ul = document.getElementById('topTags');
      ul.innerHTML = '';
      data.topTags.forEach(t => {
        const li = document.createElement('li');
        li.className = 'list-inline-item badge bg-secondary m-1';
        li.textContent = `${t.tag} (${t.count})`;
        ul.appendChild(li);
      });
    });
  </script>
</body>
</html>
